<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manajemen Barang IN/OUT Lokal</title>
<style>
    body { font-family: Arial, sans-serif; background: #f2f6fb; padding: 20px; }
    h2 { text-align: center; color: #333; margin-bottom: 20px; }
    form { text-align: center; margin-bottom: 20px; }
    input, select, button {
        padding: 8px; margin: 5px;
        border: 1px solid #ccc; border-radius: 5px;
    }
    button {
        background: #007bff; color: white; cursor: pointer;
    }
    button:hover { background: #0056b3; }
    table {
        border-collapse: collapse; width: 95%;
        margin: auto; background: white;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    th, td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
    }
    th { background-color: #007bff; color: white; }
    .total { text-align: center; font-weight: bold; margin-top: 15px; }
    #searchBox {
        display: block;
        width: 60%;
        margin: 0 auto 20px;
        padding: 10px;
        border: 2px solid #007bff;
        border-radius: 8px;
        font-size: 14px;
    }
</style>
</head>
<body>

<h2>📦 Manajemen Barang IN/OUT </h2>

<form id="barangForm">
    <input type="text" id="nama" placeholder="Nama Barang" required>
    <input type="number" id="jumlah" placeholder="Jumlah PCS" required>
    <select id="status" required>
        <option value="IN">IN (Masuk)</option>
        <option value="OUT">OUT (Keluar)</option>
    </select>
    <button type="submit">Tambah Barang</button>
</form>

<input type="text" id="searchBox" placeholder="🔍 Cari berdasarkan nama atau status (IN/OUT)...">

<table id="tabelBarang">
    <thead>
        <tr>
            <th>No</th>
            <th>Nama Barang</th>
            <th>Jumlah (PCS)</th>
            <th>Status</th>
            <th>Tanggal</th>
            <th>Aksi</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<p class="total" id="totalBarang">Total Barang: 0 PCS</p>

<script>
    let barangList = JSON.parse(localStorage.getItem('barangList')) || [];
    let editIndex = -1;

    const form = document.getElementById('barangForm');
    const namaInput = document.getElementById('nama');
    const jumlahInput = document.getElementById('jumlah');
    const statusSelect = document.getElementById('status');
    const tabelBody = document.querySelector('#tabelBarang tbody');
    const totalDisplay = document.getElementById('totalBarang');
    const searchBox = document.getElementById('searchBox');

    // Simpan ke localStorage
    function simpanData() {
        localStorage.setItem('barangList', JSON.stringify(barangList));
    }

    // Render tabel
    function renderTabel(filter = "") {
        tabelBody.innerHTML = '';
        let total = 0;
        let filteredList = barangList.filter(b => 
            b.nama.toLowerCase().includes(filter.toLowerCase()) ||
            b.status.toLowerCase().includes(filter.toLowerCase())
        );

        filteredList.forEach((barang, index) => {
            if (barang.status === "IN") total += barang.jumlah;
            else if (barang.status === "OUT") total -= barang.jumlah;

            const row = `
                <tr>
                    <td>${index + 1}</td>
                    <td>${barang.nama}</td>
                    <td>${barang.jumlah}</td>
                    <td>${barang.status}</td>
                    <td>${barang.tanggal}</td>
                    <td>
                        <button onclick="editBarang(${barangList.indexOf(barang)})">Edit</button>
                        <button onclick="hapusBarang(${barangList.indexOf(barang)})" style="background:#dc3545;">Hapus</button>
                    </td>
                </tr>
            `;
            tabelBody.innerHTML += row;
        });

        totalDisplay.textContent = `Total Barang di Gudang: ${total} PCS`;
    }

    // Tambah / Update data
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        const nama = namaInput.value.trim();
        const jumlah = parseInt(jumlahInput.value);
        const status = statusSelect.value;
        const tanggal = new Date().toLocaleString('id-ID', { 
            day: '2-digit', month: '2-digit', year: 'numeric', 
            hour: '2-digit', minute: '2-digit'
        });

        if (nama === '' || isNaN(jumlah) || jumlah <= 0) {
            alert('Masukkan data yang valid!');
            return;
        }

        if (editIndex === -1) {
            barangList.push({ nama, jumlah, status, tanggal });
        } else {
            barangList[editIndex] = { nama, jumlah, status, tanggal };
            editIndex = -1;
            form.querySelector('button').textContent = 'Tambah Barang';
        }

        simpanData();
        renderTabel(searchBox.value);
        form.reset();
    });

    function editBarang(index) {
        const barang = barangList[index];
        namaInput.value = barang.nama;
        jumlahInput.value = barang.jumlah;
        statusSelect.value = barang.status;
        editIndex = index;
        form.querySelector('button').textContent = 'Update Barang';
    }

    function hapusBarang(index) {
        if (confirm('Yakin ingin menghapus data ini?')) {
            barangList.splice(index, 1);
            simpanData();
            renderTabel(searchBox.value);
        }
    }

    // Event pencarian
    searchBox.addEventListener('input', () => renderTabel(searchBox.value));

    // Render pertama kali
    renderTabel();
</script>

</body>
</html>
